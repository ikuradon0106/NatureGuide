<%# 現在のユーザーがこのグループ(=@group)に参加済みかを判定 %>
<% if @group.users.include?(current_user) %>
  <p>すでにこのグループに参加しています。</p>

<%# 指定のユーザーが指定のグループに参加申請中（pending または requested）かどうか判定するクラスメソッドを使用（GroupRequestモデルに記載） %>
<% elsif GroupRequest.requesting?(current_user, @group) %>
  <p>参加申請中です。承認をお待ちください。</p>

<%# 上記のいずれかでもない場合は、参加申請ボタンを表示 %>
<% else %>
<%= form_with url: group_group_requests_path(@group), method: :post do |f| %>
  <%= f.hidden_field :user_id, value: current_user.id %>
  <%= f.submit "参加申請", class: "btn btn-primary" %>
<% end %>


<% end %>
